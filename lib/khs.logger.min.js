/*! khs.logger - v0.0.4 2014-01-17 */
!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(a){function b(a,b){return(1e15+a+"").slice(-b)}function c(b,c){var d=function(d){if(h){d.stopPropagation(),e(i)&&(null!==i&&a("#khstooltip").remove(),b.attr("title",j)),j=b.attr("title"),b.attr("title","showing");var f="";for(var g in a.Log.inspectors)f+=a.Log.inspectors[g].call(null,b);var k=c+f;a("body").append('<div id="khstooltip"><div class="khstipHeader"><span class="closeButton">X</span></div><div class="khstipBody"><h>'+k+'</div><div class="khstipFooter"></div></div>'),a("#khstooltip").css("top",d.pageY).css("left",d.pageX).fadeIn("500").fadeTo("10",.8),a("#khstooltip .closeButton").css({"float":"right","font-size":"14px","background-color":"#FFFFFF",color:"#000000",padding:"4px","margin-top":"8px","font-weight":"700"}).hover(function(){a(this).css({"background-color":"#000000",color:"#ffffff",cursor:"pointer"})},function(){a(this).css({"background-color":"#FFFFFF",color:"#000000"})}).on("click",this,function(){a(this).parents("#khstooltip").remove()})}};b.mouseenter(function(){i=b,h&&(i.css("outline","medium solid #FF0000"),i.attr("title","showing"),i.dblclick(d))}).mousemove(function(){}).mouseleave(function(){null!==i&&(i.attr("title",j),i.css("outline",""),i=null),b.css("outline","")})}function d(b){var c=localStorage["local.logs"],d=null;d=null===c||void 0===c||""===c?{entries:[]}:JSON.parse(c),d.entries.push(b),d.entries.length>a.Log.logLength&&d.entries.shift(),localStorage["local.logs"]=JSON.stringify(d)}function e(a){var b=a.attr("title");return"showing"==b}function f(){var b=" #khstooltip {  position:absolute;  z-index:9999;  color:#fff;  font-size:10px;  width:580px; }",c=" #khstooltip .khstipHeader {  height:8px; } ",d="/* IE hack */*html #khstooltip .khstipHeader {margin-bottom:-6px;}",e="#khstooltip .khstipBody { background-color:#000;  padding:5px;  }",f="#khstooltip .khstipFooter { height:8px;  } ",g="<style>"+b+c+d+e+f+"</style>";a(g).appendTo("body")}function g(){window.onkeydown=function(b){if(-1!=a.Log.keyCodes.indexOf(b.keyCode)&&b.ctrlKey&&(a.Log.showOutline(),a.Log.isInspecting()?(a.Log.inspectOff(),a.Log.debug("inspecting off")):(a.Log.inspectOn(),a.Log.debug("inspecting on"))),b.keyCode==a.Log.modelDumpKeyCode&&b.ctrlKey){for(var c=a("[data-json]").map(function(){return a(this).attr("data-json")}).get(),d="",e="",f=0;f<c.length;f++){var g=c[f].split("<~>");d=g[0],model=g[1],e=e+"<b>"+d+"</b></br><textarea rows='20' cols='80'>"+model+"</textarea></br>"}var h=window.open();h.document.write("<html><head><title>JSON MODELS</title></head><body><div class='khstipBody'>"+e+"</div><div class='khstipFooter'></div></body></html>")}},window.onkeyup=function(b){-1!=a.Log.keyCodes.indexOf(b.keyCode)&&a.Log.hideOutline()},f()}var h=!1,i=null,j=null,k=!1;window.console||(window.console={}),window.console.log||(window.console.log=function(){}),window.console.info||(window.console.info=function(){}),window.console.debug||(window.console.debug=function(){}),window.console.error||(window.console.error=function(){}),window.console.warn||(window.console.warn=function(){}),a.LogLevel={log:0,debug:1,info:2,warn:3,error:4},a.Log={keyCodes:[10,13],logKeyCode:17,level:a.LogLevel.info,modelDumpKeyCode:77,divs:{},inspectors:[],logLocal:!1,logLength:100,remoteLevel:a.LogLevel.error,color:"#FF0000",remoteUrl:null,beforeSend:null,log:function(b){if(this.level<=a.LogLevel.log){var c=n("LOG",b);this.remoteLevel<=a.LogLevel.log&&o(this.remoteUrl,c,this.beforeSend),this.logLocal&&d(c),console.log(c)}},info:function(b){if(this.level<=a.LogLevel.info){var c=n("INFO",b);this.remoteLevel<=a.LogLevel.info&&o(this.remoteUrl,c,this.beforeSend),this.logLocal&&d(c),console.info(c)}},debug:function(b){if(this.level<=a.LogLevel.debug){var c=n("DEBUG",b);this.remoteLevel<=a.LogLevel.debug&&o(this.remoteUrl,c,this.beforeSend),this.logLocal&&d(c),console.debug(c)}},error:function(b){if(this.level<=a.LogLevel.error){var c=n("ERROR",b);this.remoteLevel<=a.LogLevel.error&&o(this.remoteUrl,c,this.beforeSend),this.logLocal&&d(c),console.error(c)}},warn:function(b){if(this.level<=a.LogLevel.warn){var c=n("WARN",b);this.remoteLevel<=a.LogLevel.warn&&o(this.remoteUrl,c,this.beforeSend),this.logLocal&&d(c),console.warn(c)}},inspect:function(){k=!0,g()},inspectOn:function(){h=!0},inspectOff:function(){h=!1},isInspecting:function(){return h},install:function(a){this.inspectors.push(a)},mark:function(b,d,e){if(k){var f,g="<b>Model:<b>&nbsp;</br>",h="<div><b>Id:&nbsp;</b>"+b.attr("id")+"</br><b>View:&nbsp;</b>"+d+"</div>";null!==e&void 0!==e&&(f=m(e,""),g+="<div style='max-height : 512px; overflow : auto;'><pre>"+f+"</pre></div>",h+=g);var i=b.attr("id")+d;this.divs[i]=b,c(b,h),e&&b.attr("data-json",d+"<~>"+f),a.Log.info("Marked "+d+" for inspection")}},showOutline:function(){for(var a in this.divs)this.divs[a].css("outline","medium solid #FF0000")},hideOutline:function(){for(var a in this.divs)this.divs[a].css("outline","")},localStorageLogInspector:function(){return function(){var b="<b>Log Entries ("+a.Log.logLength+")</b>";b+="<div style='height : 150px; overflow : auto;'><pre>";var c=JSON.parse(localStorage["local.logs"]);for(var d in c.entries)b+=c.entries[d]+"</br>";return b+="</pre></div>"}},localLogEntries:function(){return JSON.parse(localStorage["local.logs"])},resetLocalLog:function(){localStorage["local.logs"]=""}};var l=function(a){return"object"==typeof a?null===a?"null":a.constructor===[].constructor?"array":a.constructor===(new Date).constructor?"date":a.constructor===(new RegExp).constructor?"regex":"object":typeof a},m=function(b,c){var d,e;arguments.length<2&&(c="");var f="    ",g=l(b);if("array"===g){if(0===b.length)return"[]";d="["}else{if(e=0,a.each(b,function(){e++}),0===e)return"{}";d="{"}return e=0,a.each(b,function(a,b){switch(e>0&&(d+=","),d+="array"==g?"\n"+c+f:"\n"+c+f+'"'+a+'": ',l(b)){case"array":case"object":d+=m(b,c+f);break;case"boolean":case"number":d+=b.toString();break;case"null":d+="null";break;case"string":d+='"'+b+'"';break;default:d+="TYPEOF: "+typeof b}e++}),d+="array"==g?"\n"+c+"]":"\n"+c+"}"},n=function(c,d){a.Log.prefix&&(c="function"==typeof a.Log.prefix?c+":"+a.Log.prefix():c+":"+a.Log.prefix);var e=new Date,f=e.getFullYear()+"-"+(e.getMonth()+1)+"-"+e.getDate()+":"+b(e.getHours(),2)+":"+b(e.getMinutes(),2)+":"+b(e.getSeconds(),2)+":"+b(e.getMilliseconds(),3);return c+":"+f+"->"+d},o=function(b,c,d){if(null!==b){var e=b;a.ajax({url:e,type:"POST",contentType:"application/json",data:JSON.stringify({log:c}),beforeSend:d,success:function(){},error:function(){console.error("Error sending remote log message to - "+e)}})}};return a(function(){}),a.Log});